# Temporary nginx config for local testing of datax-cash-site
# Root is set to container web root (/usr/share/nginx/html)

log_format json_combined escape=json '{
  "ts":"$time_iso8601",
  "request_id":"$request_id",
  "client_ip":"$remote_addr",
  "method":"$request_method",
  "path":"$request_uri",
  "status":$status,
  "bytes_sent":$bytes_sent,
  "referer":"$http_referer",
  "user_agent":"$http_user_agent"
}';

access_log /var/log/nginx/datax_access.log json_combined;

server {
  listen 80;
  server_name localhost;
  root /usr/share/nginx/html;

  # Example downloads location - adjust if you use X-Accel-Redirect
  location /downloads/ {
    alias /usr/share/nginx/html/downloads/;
    # Separate access log for downloads (optional)
    access_log /var/log/nginx/datax_downloads.log json_combined;
    # Serve files directly from disk
    try_files $uri =404;
  }

  # Serve static files
  location / {
    try_files $uri $uri/ =404;
  }
}
