# Example nginx config snippet for datax.cash
# JSON access_log format and a downloads location with separate log

log_format json_combined escape=json '{
  "ts":"$time_iso8601",
  "request_id":"$request_id",
  "client_ip":"$remote_addr",
  "method":"$request_method",
  "path":"$request_uri",
  "status":$status,
  "bytes_sent":$bytes_sent,
  "referer":"$http_referer",
  "user_agent":"$http_user_agent"
}';

access_log /var/log/nginx/datax_access.log json_combined;

server {
  listen 80;
  server_name datax.cash;
  root /var/www/datax-cash-site;

  location /downloads/ {
    # Example: route requests to an internal location after auth checks.
    # If using X-Accel-Redirect, set internal redirects to a filesystem path.
    internal;
    # Separate access log for downloads
  }

  # Serve static files
  location / {
    try_files $uri $uri/ =404;
  }
}

# Note: For download logging, consider a dedicated location and access_log directive:
# location /downloads/ {
#   alias /var/storage/downloads/;
#   access_log /var/log/nginx/datax_downloads.log json_combined;
# }
